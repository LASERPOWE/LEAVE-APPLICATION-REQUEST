<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Leave Application Form</title>
  <style>
    body { font-family: sans-serif; background: #f5f5f5; display: flex; justify-content: center; padding: 40px; }
    form { background: white; padding: 20px; border-radius: 10px; width: 400px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    input, textarea, select, button { width: 100%; margin: 10px 0; padding: 10px; font-size: 14px; }
    button { background-color: green; color: white; border: none; cursor: pointer; }
  </style>
</head>
<body>

<form id="leaveForm">
  <h2>Leave Application Form</h2>

  <input type="text" name="emp_code" placeholder="EMP CODE" required />
  <input type="text" name="emp_name" placeholder="EMP NAME" required />
  <input type="text" name="hod" placeholder="HOD" required />
  <input type="text" name="design_name" placeholder="DESIGN NAME" required />
  <input type="text" name="dept_name" placeholder="DEPT NAME" required />
  <select name="leave_type" required>
    <option value="CL">CL</option>
    <option value="SL">SL</option>
    <option value="COFF">COFF</option>
  </select>
  <input type="date" name="from_date" required />
  <input type="date" name="to_date" required />
  <textarea name="reason" placeholder="REASON" required></textarea>
  <input type="text" name="leave_count" placeholder="TAKEN LEAVE COUNT" required />
  <input type="email" name="hod_mail" placeholder="HOD MAIL" required />
  <input type="email" name="user_mail" placeholder="USER MAIL" required />

  <button type="submit">Submit</button>
</form>

<script>
  const form = document.getElementById("leaveForm");
  const scriptURL = "https://script.google.com/macros/s/AKfycbx5ls8ZOaqIbeQL1yeNgqcw994xp1dkLHCjgqkR1uz24GPwCak4XSk7nn_Mdkz7MkRmDg/exec";

  form.addEventListener("submit", e => {
    e.preventDefault();
    const formData = new FormData(form);
    const data = {};

    formData.forEach((value, key) => {
      data[key] = value;
    });

    fetch(scriptURL, {
      method: "POST",
      mode: "no-cors", // IMPORTANT
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(data)
    })
    .then(() => alert("Submitted Successfully!"))
    .catch(err => alert("Error: " + err));
  });
</script>

</body>
</html>
